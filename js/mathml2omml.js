/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/mathml2omml@0.5.0/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const xmlDecodeTree=new Uint16Array("Ȁaglq\tɭ\0\0p;䀦os;䀧t;䀾t;䀼uot;䀢".split("").map((t=>t.charCodeAt(0))));var _a;const decodeMap=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),fromCodePoint=null!==(_a=String.fromCodePoint)&&void 0!==_a?_a:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|1023&t),e+=String.fromCharCode(t),e};function replaceCodePoint(t){var e;return t>=55296&&t<=57343||t>1114111?65533:null!==(e=decodeMap.get(t))&&void 0!==e?e:t}var CharCodes;!function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"}(CharCodes||(CharCodes={}));const TO_LOWER_BIT=32;var BinTrieFlags,EntityDecoderState,DecodingMode;function isNumber(t){return t>=CharCodes.ZERO&&t<=CharCodes.NINE}function isHexadecimalCharacter(t){return t>=CharCodes.UPPER_A&&t<=CharCodes.UPPER_F||t>=CharCodes.LOWER_A&&t<=CharCodes.LOWER_F}function isAsciiAlphaNumeric(t){return t>=CharCodes.UPPER_A&&t<=CharCodes.UPPER_Z||t>=CharCodes.LOWER_A&&t<=CharCodes.LOWER_Z||isNumber(t)}function isEntityInAttributeInvalidEnd(t){return t===CharCodes.EQUALS||isAsciiAlphaNumeric(t)}!function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"}(BinTrieFlags||(BinTrieFlags={})),function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"}(EntityDecoderState||(EntityDecoderState={})),function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"}(DecodingMode||(DecodingMode={}));class EntityDecoder{constructor(t,e,r){this.decodeTree=t,this.emitCodePoint=e,this.errors=r,this.state=EntityDecoderState.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=DecodingMode.Strict}startEntity(t){this.decodeMode=t,this.state=EntityDecoderState.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,e){switch(this.state){case EntityDecoderState.EntityStart:return t.charCodeAt(e)===CharCodes.NUM?(this.state=EntityDecoderState.NumericStart,this.consumed+=1,this.stateNumericStart(t,e+1)):(this.state=EntityDecoderState.NamedEntity,this.stateNamedEntity(t,e));case EntityDecoderState.NumericStart:return this.stateNumericStart(t,e);case EntityDecoderState.NumericDecimal:return this.stateNumericDecimal(t,e);case EntityDecoderState.NumericHex:return this.stateNumericHex(t,e);case EntityDecoderState.NamedEntity:return this.stateNamedEntity(t,e)}}stateNumericStart(t,e){return e>=t.length?-1:(32|t.charCodeAt(e))===CharCodes.LOWER_X?(this.state=EntityDecoderState.NumericHex,this.consumed+=1,this.stateNumericHex(t,e+1)):(this.state=EntityDecoderState.NumericDecimal,this.stateNumericDecimal(t,e))}addToNumericResult(t,e,r,n){if(e!==r){const i=r-e;this.result=this.result*Math.pow(n,i)+Number.parseInt(t.substr(e,i),n),this.consumed+=i}}stateNumericHex(t,e){const r=e;for(;e<t.length;){const n=t.charCodeAt(e);if(!isNumber(n)&&!isHexadecimalCharacter(n))return this.addToNumericResult(t,r,e,16),this.emitNumericEntity(n,3);e+=1}return this.addToNumericResult(t,r,e,16),-1}stateNumericDecimal(t,e){const r=e;for(;e<t.length;){const n=t.charCodeAt(e);if(!isNumber(n))return this.addToNumericResult(t,r,e,10),this.emitNumericEntity(n,2);e+=1}return this.addToNumericResult(t,r,e,10),-1}emitNumericEntity(t,e){var r;if(this.consumed<=e)return null===(r=this.errors)||void 0===r||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===CharCodes.SEMI)this.consumed+=1;else if(this.decodeMode===DecodingMode.Strict)return 0;return this.emitCodePoint(replaceCodePoint(this.result),this.consumed),this.errors&&(t!==CharCodes.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,e){const{decodeTree:r}=this;let n=r[this.treeIndex],i=(n&BinTrieFlags.VALUE_LENGTH)>>14;for(;e<t.length;e++,this.excess++){const a=t.charCodeAt(e);if(this.treeIndex=determineBranch(r,n,this.treeIndex+Math.max(1,i),a),this.treeIndex<0)return 0===this.result||this.decodeMode===DecodingMode.Attribute&&(0===i||isEntityInAttributeInvalidEnd(a))?0:this.emitNotTerminatedNamedEntity();if(n=r[this.treeIndex],i=(n&BinTrieFlags.VALUE_LENGTH)>>14,0!==i){if(a===CharCodes.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==DecodingMode.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:e,decodeTree:r}=this,n=(r[e]&BinTrieFlags.VALUE_LENGTH)>>14;return this.emitNamedEntityData(e,n,this.consumed),null===(t=this.errors)||void 0===t||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,e,r){const{decodeTree:n}=this;return this.emitCodePoint(1===e?n[t]&~BinTrieFlags.VALUE_LENGTH:n[t+1],r),3===e&&this.emitCodePoint(n[t+2],r),r}end(){var t;switch(this.state){case EntityDecoderState.NamedEntity:return 0===this.result||this.decodeMode===DecodingMode.Attribute&&this.result!==this.treeIndex?0:this.emitNotTerminatedNamedEntity();case EntityDecoderState.NumericDecimal:return this.emitNumericEntity(0,2);case EntityDecoderState.NumericHex:return this.emitNumericEntity(0,3);case EntityDecoderState.NumericStart:return null===(t=this.errors)||void 0===t||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case EntityDecoderState.EntityStart:return 0}}}function getDecoder(t){let e="";const r=new EntityDecoder(t,(t=>e+=fromCodePoint(t)));return function(t,n){let i=0,a=0;for(;(a=t.indexOf("&",a))>=0;){e+=t.slice(i,a),r.startEntity(n);const s=r.write(t,a+1);if(s<0){i=a+r.end();break}i=a+s,a=0===s?i+1:i}const s=e+t.slice(i);return e="",s}}function determineBranch(t,e,r,n){const i=(e&BinTrieFlags.BRANCH_LENGTH)>>7,a=e&BinTrieFlags.JUMP_TABLE;if(0===i)return 0!==a&&n===a?r:-1;if(a){const e=n-a;return e<0||e>=i?-1:t[r+e]-1}let s=r,c=s+i-1;for(;s<=c;){const e=s+c>>>1,r=t[e];if(r<n)s=e+1;else{if(!(r>n))return t[e+i];c=e-1}}return-1}const xmlDecoder=getDecoder(xmlDecodeTree);function decodeXML(t){return xmlDecoder(t,DecodingMode.Strict)}const attrRE=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function stringify$1(t){const e={type:"tag",name:"",voidElement:!1,attribs:{},children:[]},r=t.match(/<\/?([^\s]+?)[/\s>]/);if(r&&(e.name=r[1],"/"===t.charAt(t.length-2)&&(e.voidElement=!0),e.name.startsWith("!--"))){const e=t.indexOf("--\x3e");return{type:"comment",comment:-1!==e?t.slice(4,e):""}}const n=new RegExp(attrRE);let i=null;for(;i=n.exec(t),null!==i;)if(i[0].trim())if(i[1]){const t=i[1].trim();let r=[t,""];t.indexOf("=")>-1&&(r=t.split("=")),e.attribs[r[0]]=r[1],n.lastIndex--}else i[2]&&(e.attribs[i[2]]=i[3].trim().substring(1,i[3].length-1));return e}const tagRE=/<[a-zA-Z0-9\-!/](?:"[^"]*"|'[^']*'|[^'">])*>/g,whitespaceRE=/^\s*$/,textContainerNames=["mtext","mi","mn","mo","ms"];function parse(t,e={}){const r=[],n=[];let i,a=-1;return t.replace(tagRE,((s,c)=>{const l="/"!==s.charAt(1),m=s.startsWith("\x3c!--"),d=c+s.length,h=t.charAt(d);let o;if(m){const t=stringify$1(s);return a<0?(r.push(t),r):(o=n[a],o.children.push(t),r)}if(l){if(a++,i=stringify$1(s),"tag"===i.type&&e.components?.[i.name]&&(i.type="component"),textContainerNames.includes(i.name)&&!i.voidElement&&h&&"<"!==h){const r=t.slice(d,t.indexOf("<",d)).trim();i.children.push({type:"text",data:e.disableDecode?r:decodeXML(r)})}0===a&&r.push(i),o=n[a-1],o&&o.children.push(i),n[a]=i}if((!l||i.voidElement)&&(a>-1&&(i.voidElement||i.name===s.slice(2,-1))&&(a--,i=-1===a?r:n[a]),a>-1&&textContainerNames.includes[n[a].name]&&"<"!==h&&h)){o=n[a].children;const r=t.indexOf("<",d);let i=t.slice(d,-1===r?void 0:r);whitespaceRE.test(i)&&(i=" "),(r>-1&&a+o.length>=0||" "!==i)&&o.push({type:"text",data:e.disableDecode?i:decodeXML(i)})}})),r}function attrString(t){const e=[];for(const r in t)e.push(`${r}="${t[r]}"`);return e.length?` ${e.join(" ")}`:""}function stringify(t,e){switch(e.type){case"text":return t+e.data;case"tag":{const r=e.voidElement||!e.children.length&&"preserve"!==e.attribs["xml:space"];return t+=`<${e.name}${e.attribs?attrString(e.attribs):""}${r?"/>":">"}`,r?t:`${t+e.children.reduce(stringify,"")}</${e.name}>`}case"comment":return t+=`\x3c!--${e.comment}--\x3e`}}function stringifyDoc(t){return t.reduce(((t,e)=>t+stringify("",e)),"")}function math(t,e,r,n,i){return e.name="m:oMath",e.attribs={"xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},e.type="tag",e.children=[],e}function semantics(t,e,r,n,i){return e}function menclose(t,e,r,n,i){const a=t.attribs?.notation?.split(" ")[0]||"longdiv",s={type:"tag",name:"m:e",attribs:{},children:[]};if("longdiv"===a)e.children.push({type:"tag",name:"m:rad",attribs:{},children:[{type:"tag",name:"m:radPr",attribs:{},children:[{type:"tag",name:"m:degHide",attribs:{"m:val":"on"},children:[]}]},{type:"tag",name:"m:deg",attribs:{},children:[]},s]});else{const t={t:{type:"tag",name:"m:hideTop",attribs:{"m:val":"on"},children:[]},b:{type:"tag",name:"m:hideBot",attribs:{"m:val":"on"},children:[]},l:{type:"tag",name:"m:hideLeft",attribs:{"m:val":"on"},children:[]},r:{type:"tag",name:"m:hideRight",attribs:{"m:val":"on"},children:[]}},r={type:"tag",name:"m:borderBoxPr",attribs:{},children:[]},n={type:"tag",name:"m:borderBox",attribs:{},children:[]};switch(a){case"actuarial":case"radical":case"box":n.children=[s];break;case"left":case"roundedbox":r.children=[t.t,t.b,t.r],n.children=[r,s];break;case"right":case"circle":r.children=[t.t,t.b,t.l],n.children=[r,s];break;case"top":r.children=[t.b,t.l,t.r],n.children=[r,s];break;case"bottom":r.children=[t.t,t.l,t.r],n.children=[r,s];break;case"updiagonalstrike":r.children=[t.t,t.b,t.l,t.r,{type:"tag",name:"m:strikeBLTR",attribs:{"m:val":"on"},children:[]}],n.children=[r,s];break;case"downdiagonalstrike":r.children=[t.t,t.b,t.l,t.r,{type:"tag",name:"m:strikeTLBR",attribs:{"m:val":"on"},children:[]}],n.children=[r,s];break;case"verticalstrike":r.children=[t.t,t.b,t.l,t.r,{type:"tag",name:"m:strikeV",attribs:{"m:val":"on"},children:[]}],n.children=[r,s];break;case"horizontalstrike":r.children=[t.t,t.b,t.l,t.r,{type:"tag",name:"m:strikeH",attribs:{"m:val":"on"},children:[]}],n.children=[r,s];break;default:r.children=[t.t,t.b,t.l,t.r],n.children=[r,s]}e.children.push(n)}return s}function mfrac(t,e,r,n,i){if(2!==t.children.length)return e;const a=t.children[0],s=t.children[1],c={name:"m:num",type:"tag",attribs:{},children:[]},l={name:"m:den",type:"tag",attribs:{},children:[]};(i=[...i]).unshift(t),walker(a,c,!1,!1,i),walker(s,l,!1,!1,i);const m="0"===t.attribs?.linethickness?"noBar":"bar";e.children.push({type:"tag",name:"m:f",attribs:{},children:[{type:"tag",name:"m:fPr",attribs:{},children:[{type:"tag",name:"m:type",attribs:{"m:val":m},children:[]}]},c,l]})}function mglyph(t,e,r,n,i){t.attribs?.alt&&e.children.push({type:"text",data:t.attribs.alt})}function mmultiscripts(t,e,r,n,i){if(0===t.children.length)return;const a=t.children[0],s=[],c=[],l=[],m=[],d=t.children.slice(1);let h=!1;d.forEach(((t,e)=>{"mprescripts"===t.name?h=!0:"none"!==t.name&&(e%2?h?l.push(t):c.push(t):h?m.push(t):s.push(t))})),(i=[...i]).unshift(t);const o={children:[]};walker(a,o,!1,!1,i);let u=o.children[0];if(s.length||c.length){const t={name:"m:sub",type:"tag",attribs:{},children:[]};s.forEach((e=>walker(e,t,!1,!1,i)));const e={name:"m:sup",type:"tag",attribs:{},children:[]};c.forEach((t=>walker(t,e,!1,!1,i)));const r={type:"tag",attribs:{},children:[{type:"tag",name:"m:e",attribs:{},children:[u]}]};s.length&&c.length?(r.name="m:sSubSup",r.children.push(t),r.children.push(e)):s.length?(r.name="m:sSub",r.children.push(t)):(r.name="m:sSup",r.children.push(e)),u=r}if(l.length||m.length){const t={name:"m:sub",type:"tag",attribs:{},children:[]};l.forEach((e=>walker(e,t,!1,!1,i)));const e={name:"m:sup",type:"tag",attribs:{},children:[]};m.forEach((t=>walker(t,e,!1,!1,i)));u={name:"m:sPre",type:"tag",attribs:{},children:[{name:"m:e",type:"tag",attribs:{},children:[u]},t,e]}}e.children.push(u)}function mrow(t,e,r,n,i){if(r.isNary){const t=e.children[e.children.length-1];return t.children[t.children.length-1]}return e}function mspace(t,e,r,n,i){e.children.push({name:"m:r",type:"tag",attribs:{},children:[{name:"m:t",type:"tag",attribs:{"xml:space":"preserve"},children:[{type:"text",data:" "}]}]})}function msqrt(t,e,r,n,i){const a={name:"m:e",type:"tag",attribs:{},children:[]};return e.children.push({name:"m:rad",type:"tag",attribs:{},children:[{name:"m:radPr",type:"tag",attribs:{},children:[{name:"m:degHide",type:"tag",attribs:{"m:val":"on"},children:[]}]},{name:"m:deg",type:"tag",attribs:{},children:[]},a]}),a}function mstyle(t,e,r,n,i){return e}function getTextContent(t,e=!0){let r="";if("text"===t.type){let n=t.data.replace(/[\u2062]|[\u200B]/g,"");e&&(n=n.trim()),r+=n}else t.children&&t.children.forEach((t=>{r+=getTextContent(t,e)}));return r}const NARY_REGEXP=/^[\u220f-\u2211]|[\u2229-\u2233]|[\u22c0-\u22c3]$/,GROW_REGEXP=/^\u220f|\u2211|[\u2229-\u222b]|\u222e|\u222f|\u2232|\u2233|[\u22c0-\u22c3]$/;function getNary(t){const e=getTextContent(t);return!!NARY_REGEXP.test(e)&&e}function getNaryTarget(t,e,r,n=!1,i=!1){const a=e.attribs?.stretchy;return{type:"tag",name:"m:nary",attribs:{},children:[{type:"tag",name:"m:naryPr",attribs:{},children:[{type:"tag",name:"m:chr",attribs:{"m:val":t},children:[]},{type:"tag",name:"m:limLoc",attribs:{"m:val":r},children:[]},{type:"tag",name:"m:grow",attribs:{"m:val":"true"===a?"1":"false"===a?"0":GROW_REGEXP.test(t)?"1":"0"},children:[]},{type:"tag",name:"m:subHide",attribs:{"m:val":n?"on":"off"},children:[]},{type:"tag",name:"m:supHide",attribs:{"m:val":i?"on":"off"},children:[]}]}]}}function addScriptlevel(t,e){const r=e.find((t=>t.attribs?.scriptlevel))?.attribs?.scriptlevel;["0","1","2"].includes(r)&&t.children.unshift({type:"tag",name:"m:argPr",attribs:{},children:[{type:"tag",name:"m:scrLvl",attribs:{"m:val":r},children:[]}]})}function msub(t,e,r,n,i){if(2!==t.children.length)return e;(i=[...i]).unshift(t);const a=t.children[0],s=t.children[1];let c;const l=getNary(a);if(l&&"true"!==t.attribs?.accent?.toLowerCase()&&"true"!==t.attribs?.accentunder?.toLowerCase())c=getNaryTarget(l,t,"subSup",!1,!0),t.isNary=!0;else{const t={name:"m:e",type:"tag",attribs:{},children:[]};walker(a,t,!1,!1,i),c={type:"tag",name:"m:sSub",attribs:{},children:[{type:"tag",name:"m:sSubPr",attribs:{},children:[{type:"tag",name:"m:ctrlPr",attribs:{},children:[]}]},t]}}const m={name:"m:sub",type:"tag",attribs:{},children:[]};walker(s,m,!1,!1,i),c.children.push(m),t.isNary&&(c.children.push({type:"tag",name:"m:sup",attribs:{},children:[]}),c.children.push({type:"tag",name:"m:e",attribs:{},children:[]})),e.children.push(c)}function msubsup(t,e,r,n,i){if(3!==t.children.length)return e;(i=[...i]).unshift(t);const a=t.children[0],s=t.children[1],c=t.children[2];let l;const m=getNary(a);if(m&&"true"!==t.attribs?.accent?.toLowerCase()&&"true"!==t.attribs?.accentunder?.toLowerCase())l=getNaryTarget(m,t,"subSup"),t.isNary=!0;else{const t={name:"m:e",type:"tag",attribs:{},children:[]};walker(a,t,!1,!1,i),l={type:"tag",name:"m:sSubSup",attribs:{},children:[{type:"tag",name:"m:sSubSupPr",attribs:{},children:[{type:"tag",name:"m:ctrlPr",attribs:{},children:[]}]},t]}}const d={name:"m:sub",type:"tag",attribs:{},children:[]},h={name:"m:sup",type:"tag",attribs:{},children:[]};walker(s,d,!1,!1,i),walker(c,h,!1,!1,i),l.children.push(d),l.children.push(h),t.isNary&&l.children.push({type:"tag",name:"m:e",attribs:{},children:[]}),e.children.push(l)}function msup(t,e,r,n,i){if(2!==t.children.length)return e;(i=[...i]).unshift(t);const a=t.children[0],s=t.children[1];let c;const l=getNary(a);if(l&&"true"!==t.attribs?.accent?.toLowerCase()&&"true"!==t.attribs?.accentunder?.toLowerCase())c=getNaryTarget(l,t,"subSup",!0),t.isNary=!0,c.children.push({type:"tag",name:"m:sub"});else{const t={name:"m:e",type:"tag",attribs:{},children:[]};walker(a,t,!1,!1,i),c={type:"tag",name:"m:sSup",attribs:{},children:[{type:"tag",name:"m:sSupPr",attribs:{},children:[{type:"tag",name:"m:ctrlPr",attribs:{},children:[]}]},t]}}const m={name:"m:sup",type:"tag",attribs:{},children:[]};walker(s,m,!1,!1,i),c.children.push(m),t.isNary&&c.children.push({type:"tag",name:"m:e",attribs:{},children:[]}),e.children.push(c)}function mtable(t,e,r,n,i){const a={name:"m:m",type:"tag",attribs:{},children:[{name:"m:mPr",type:"tag",attribs:{},children:[{name:"m:baseJc",type:"tag",attribs:{"m:val":"center"},children:[]},{name:"m:plcHide",type:"tag",attribs:{"m:val":"on"},children:[]},{name:"m:mcs",type:"tag",attribs:{},children:[{name:"m:mc",type:"tag",attribs:{},children:[{name:"m:mcPr",type:"tag",attribs:{},children:[{name:"m:count",type:"tag",attribs:{"m:val":Math.max(...t.children.map((t=>t.children.length))).toString()},children:[]},{name:"m:mcJc",type:"tag",attribs:{"m:val":"center"},children:[]}]}]}]}]}]};return e.children.push(a),a}function mtd(t,e,r,n,i){const a={name:"m:e",type:"tag",attribs:{},children:[]};return e.children.push(a),a}function mtr(t,e,r,n,i){const a={name:"m:mr",type:"tag",attribs:{},children:[]};return e.children.push(a),a}function munderover(t,e,r,n,i){if(3!==t.children.length)return e;(i=[...i]).unshift(t);const a=t.children[0],s=t.children[1],c=t.children[2],l=getNary(a);if(l&&"true"!==t.attributes?.accent?.toLowerCase()&&"true"!==t.attributes?.accentunder?.toLowerCase()){const r=getNaryTarget(l,t,"undOvr");t.isNary=!0;const n={name:"m:sub",type:"tag",attribs:{},children:[]},a={name:"m:sup",type:"tag",attribs:{},children:[]};return walker(s,n,!1,!1,i),walker(c,a,!1,!1,i),r.children.push(n),r.children.push(a),r.children.push({type:"tag",name:"m:e",attribs:{},children:[]}),void e.children.push(r)}const m={name:"m:e",type:"tag",attribs:{},children:[]};walker(a,m,!1,!1,i);const d={name:"m:lim",type:"tag",attribs:{},children:[]},h={name:"m:lim",type:"tag",attribs:{},children:[]};walker(s,d,!1,!1,i),walker(c,h,!1,!1,i),e.children.push({type:"tag",name:"m:limUpp",attribs:{},children:[{type:"tag",name:"m:e",attribs:{},children:[{type:"tag",name:"m:limLow",attribs:{},children:[m,d]}]},h]})}function getStyle(t,e,r={}){const n=t.attribs||{},i=n.mathcolor||e.find((t=>"mstyle"===t.name&&t.attribs&&t.attribs.color))?.attribs.color||"",a=n.mathsize||e.find((t=>"mstyle"===t.name&&t.attribs&&t.attribs.mathsize))?.attribs.mathsize||"",s=n.scriptlevel||e.find((t=>"mstyle"===t.name&&t.attribs&&t.attribs.scriptlevel))?.attribs.scriptlevel||"",c=n.mathbackground||e.find((t=>"mstyle"===t.name&&t.attribs&&t.attribs.mathbackground))?.attribs.mathbackground||"";let l=n.mathvariant||e.find((t=>"mstyle"===t.name&&t.attribs&&t.attribs.mathvariant))?.attribs.mathvariant||"";"b-i"===l&&(l="bold-italic");const m=n.fontweight||e.find((t=>"mstyle"===t.name&&t.attribs&&t.attribs.fontweight))?.attribs.fontweight||"";"bold"!==m||["bold","bold-italic"].includes(l)?"normal"===m&&["bold","bold-italic"].includes(l)&&(l=l.includes("italic")?"italic":""):l=l.includes("italic")?"bold-italic":"bold";const d=n.fontstyle||e.find((t=>"mstyle"===t.name&&t.attribs&&t.attribs.fontstyle))?.attribs.fontstyle||"";if("italic"!==d||["italic","bold-italic"].includes(l)?"normal"===d&&["italic","bold-italic"].includes(l)&&(l=l.includes("bold")?"bold":""):l=l.includes("bold")?"bold-italic":"italic",!n.mathvariant){const e=getTextContent(t);""===r.variant&&("mi"===t.name&&e.length>1||"mn"===t.name&&!/^\d+\.\d+$/.test(e))?l="":["mi","mn","mo"].includes(t.name)&&["italic","bold-italic"].includes(r.variant)&&(l="bold"===m?"bold-italic":"italic")}return{color:i,variant:l,size:a,scriptlevel:s,background:c,fontstyle:d}}const STYLES={bold:"b",italic:"i","bold-italic":"bi"};function textContainer(t,e,r,n,i,a){if(r.isNary){const t=e.children[e.children.length-1];e=t.children[t.children.length-1]}const s=t.children?.find((t=>"mglyph"===t.name)),c=getStyle(t,i,r?.style);t.style=c,t.hasMglyphChild=s;const l=Object.keys(c).every((t=>{const e=r?.style;return e&&c[t]===e[t]}))&&r?.hasMglyphChild===s;let m;if((a===r?.name||["mi","mn","mo"].includes(a)&&["mi","mn","mo"].includes(r?.name))&&l&&!s){const t=e.children[e.children.length-1];m=t.children[t.children.length-1]}else{const t={name:"m:r",type:"tag",attribs:{},children:[]};if(c.variant){const e={name:"w:rPr",type:"tag",attribs:{},children:[]};c.variant.includes("bold")&&e.children.push({name:"w:b",type:"tag",attribs:{},children:[]}),c.variant.includes("italic")&&e.children.push({name:"w:i",type:"tag",attribs:{},children:[]}),t.children.push(e);const r={name:"m:rPr",type:"tag",attribs:{},children:[{name:"m:nor",type:"tag",attribs:{},children:[]}]};"italic"!==c.variant&&r.children.push({name:"m:sty",type:"tag",attribs:{"m:val":STYLES[c.variant]},children:[]}),t.children.push(r)}else s||"mtext"===a?t.children.push({name:"m:rPr",type:"tag",attribs:{},children:[{name:"m:nor",type:"tag",attribs:{},children:[]}]}):("normal"===c.fontstyle||"ms"===a&&""===c.fontstyle)&&t.children.push({name:"m:rPr",type:"tag",attribs:{},children:[{name:"m:sty",type:"tag",attribs:{"m:val":"p"},children:[]}]});m={name:"m:t",type:"tag",attribs:{"xml:space":"preserve"},children:[]},t.children.push(m),e.children.push(t)}return m}function mtext(t,e,r,n,i){return textContainer(t,e,r,n,i,"mtext")}function mi(t,e,r,n,i){return textContainer(t,e,r,n,i,"mi")}function mn(t,e,r,n,i){return textContainer(t,e,r,n,i,"mn")}function mo(t,e,r,n,i){return textContainer(t,e,r,n,i,"mo")}function ms(t,e,r,n,i){return textContainer(t,e,r,n,i,"ms")}const UPPER_COMBINATION={"←":"⃖","⟵":"⃖","→":"⃗","⟶":"⃗","´":"́","˝":"̋","˘":"̆","ˇ":"̌","¸":"̒","^":"̂","¨":"̈","˙":"̇","`":"̀","-":"̅","¯":"̅","−":"̅",".":"̇","~":"̃","˜":"̃"};function underOrOver(t,e,r,n,i,a){if(2!==t.children.length)return e;(i=[...i]).unshift(t);const s=t.children[0],c=t.children[1],l=getNary(s);if(l&&"true"!==t.attribs?.accent?.toLowerCase()&&"true"!==t.attribs?.accentunder?.toLowerCase()){const r=getNaryTarget(l,t,"undOvr","over"===a,"under"===a);t.isNary=!0;const n={name:"m:sub",type:"tag",attribs:{},children:[]},s={name:"m:sup",type:"tag",attribs:{},children:[]};return walker(c,"under"===a?n:s,!1,!1,i),r.children.push(n),r.children.push(s),r.children.push({type:"tag",name:"m:e",attribs:{},children:[]}),void e.children.push(r)}const m=getTextContent(c),d={name:"m:e",type:"tag",attribs:{},children:[]};if(walker(s,d,!1,!1,i),"under"===a&&"mo"===c.name&&["̲","_"].includes(m)||"over"===a&&"mo"===c.name&&["̅","¯"].includes(m))return void e.children.push({type:"tag",name:"m:bar",attribs:{},children:[{type:"tag",name:"m:barPr",attribs:{},children:[{type:"tag",name:"m:pos",attribs:{"m:val":"under"===a?"bot":"top"},children:[]}]},{type:"tag",name:"m:e",attribs:{},children:[{type:"tag",name:"under"===a?"m:sSub":"m:sSup",attribs:{},children:[{type:"tag",name:"under"===a?"m:sSubPr":"m:sSupPr",attribs:{},children:[{type:"tag",name:"m:ctrlPr",attribs:{},children:[]}]},d,{type:"tag",name:"m:sub",attribs:{},children:[]}]}]}]});if("under"===a&&"true"===t.attribs?.accentunder?.toLowerCase()&&"mo"===c.name&&m.length<2||"over"===a&&"true"===t.attribs?.accent?.toLowerCase()&&"mo"===c.name&&m.length<2)return void e.children.push({type:"tag",name:"m:acc",attribs:{},children:[{type:"tag",name:"m:accPr",attribs:{},children:[{type:"tag",name:"m:chr",attribs:{"m:val":UPPER_COMBINATION[m]||m},children:[]}]},d]});if("true"!==t.attribs?.accent?.toLowerCase()&&"true"!==t.attribs?.accentunder?.toLowerCase()&&"mo"===c.name&&"mrow"===s.name&&1===m.length)return void e.children.push({type:"tag",name:"m:groupChr",attribs:{},children:[{type:"tag",name:"m:groupChrPr",attribs:{},children:[{type:"tag",name:"m:chr",attribs:{"m:val":m,"m:pos":"under"===a?"bot":"top"},children:[]}]},d]});const h={name:"m:lim",type:"tag",attribs:{},children:[]};walker(c,h,!1,!1,i),e.children.push({type:"tag",name:"under"===a?"m:limLow":"m:limUpp",attribs:{},children:[d,h]})}function munder(t,e,r,n,i){return underOrOver(t,e,r,n,i,"under")}function mover(t,e,r,n,i){return underOrOver(t,e,r,n,i,"over")}function mroot(t,e,r,n,i){if(2!==t.children.length)return e;(i=[...i]).unshift(t);const a=t.children[0],s=t.children[1],c={type:"tag",name:"m:e",attribs:{},children:[]};walker(a,c,!1,!1,i);const l={type:"tag",name:"m:deg",attribs:{},children:[]};walker(s,l,!1,!1,i);const m=getTextContent(s);e.children.push({type:"tag",name:"m:rad",attribs:{},children:[{type:"tag",name:"m:radPr",attribs:{},children:[{type:"tag",name:"m:degHide",attribs:{"m:val":m.length?"off":"on"},children:[]}]},l,c]})}function text(t,e,r,n,i){let a=t.data.replace(/[\u2062]|[\u200B]/g,"");if(i.find((t=>["mi","mn","mo"].includes(t.name))))a=a.replace(/\s/g,"");else{const t=i.find((t=>"ms"===t.name));t&&(a=(t.attribs?.lquote||'"')+a+(t.attribs?.rquote||'"'))}return a.length&&(e.children.length&&"text"===e.children[e.children.length-1].type?e.children[e.children.length-1].data+=a:e.children.push({type:"text",data:a})),e}var mathmlHandlers=Object.freeze({__proto__:null,math:math,menclose:menclose,mfrac:mfrac,mglyph:mglyph,mi:mi,mmultiscripts:mmultiscripts,mn:mn,mo:mo,mover:mover,mroot:mroot,mrow:mrow,ms:ms,mspace:mspace,msqrt:msqrt,mstyle:mstyle,msub:msub,msubsup:msubsup,msup:msup,mtable:mtable,mtd:mtd,mtext:mtext,mtr:mtr,munder:munder,munderover:munderover,semantics:semantics,text:text});function walker(t,e,r=!1,n=!1,i=[]){let a;!r&&["m:deg","m:den","m:e","m:fName","m:lim","m:num","m:sub","m:sup"].includes(e.name)&&addScriptlevel(e,i);const s=t.name||t.type;if(mathmlHandlers[s]?a=mathmlHandlers[s](t,e,r,n,i):(s&&"root"!==s&&console.warn(`Type not supported: ${s}`),a=e),a&&t.children?.length){(i=[...i]).unshift(t);for(let e=0;e<t.children.length;e++)walker(t.children[e],a,t.children[e-1],t.children[e+1],i)}}class MML2OMML{constructor(t,e={}){this.inString=t,this.inXML=parse(t,e),this.outXML=!1,this.outString=!1}run(){const t={};walker({children:this.inXML,type:"root"},t),this.outXML=t}getResult(){return this.outString=stringifyDoc([this.outXML]),this.outString}}const mml2omml=(t,e)=>{const r=new MML2OMML(t,e);return r.run(),r.getResult()};
//# sourceMappingURL=/sm/a07410d076cda97d2e327b011f3006e7df1aa3cfa28d80d59aaee15bb20c4485.map